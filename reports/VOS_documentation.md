#동영상 객체 분할 기술 동향

### 동영상 객체 분할(VOS) 기술

1. 비지도 동영상 객체 분할: 사용자가 어떠한 정보도 주지 않은 상태에서 배경으로부터 객체를 분할해내는 방식이다. 주로 동영상에서 자주 출연하는 ‘주요 객체’를 자동으로 탐지하는 것에 초점을 맞추고 있다. 
    1. 기술 동향: RGB 영상과 움직임 정보를 함께 처리하는 인코더-디코더 구조의 심층 신경망이 주로 사용된다. 2020년 4월 기준으로 정지해 있는 객체에 대한 정확도를 높이기 위해 특징 맵의 벡터 간 내적을 통해 객체를 찾는 프레임 간 정합(matching)기법이 가장 많이 쓰인다.
    2. 벡터 간 내적을 사용하는 이유:  세 개의 요소를 가진 두 특징 벡터  $\mathbf{a} = [a_1, a_2, a_3]$,   $\mathbf{b} = [b_1, b_2, b_3]$가 있을 때 내적 연산은 $\mathbf{a} \cdot \mathbf{b} = a_1b_1 + a_2b_2 + a_3b_3$ 이렇게 진행된다. 이 계산은  $\mathbf{a} \cdot \mathbf{b} = |\mathbf{a}| |\mathbf{b}| \cos(\theta)$ 형식으로 계산이 가능한데 코사인 함수의 성질로 인해 세 가지 결과로 나눠진다.
        1. 두 벡터가 완전히 같은 방향일 때$(\theta = 0\degree):cos(0\degree)=1$이 되어 내적 값이 최대가 된다. 이것은 두 특징이 매우 유사하다는 것을 의미한다.
        2. 두 벡터가 직각일 때$(\theta=90\degree):cos(90\degree)=0$이 되어 내적 값이 0이 된다. 이것은 두 특징 간의 연관성이 없다는 것을 의미한다.
        3. 두 벡터가 정반대일 때$(\theta=180\degree):cos(180\degree)=-1$이 되어 내적 값이 최소가 된다. 이것은 두 특징의 성향이 정 반대임을 의미한다.
2. 준지도 동영상 객체 분할: 동영상의 첫 프레임에서 사용자가 타겟 객체에 대한 정확한 분할 영역을 제공하면, 이를 이용해 이후 프레임들에서 타겟 객체를 분할한다.
    1. 기술 동향: 초기에는 첫 프레임 정보를 이용해 신경망을 미세 조정하는 방식을 시도했지만, 속도와 객체 변형 대처에 한계가 있었다. 이를 극복하기 위해 분할 영역을 전파하고 보정하는 방식들이 제안되었다. 2020년 4월 기준 트렌드는 임베딩 공간에서 타겟 객체와 특징 거리가 가까운 픽셀들을 분류해내는 정합 방식이었고, 속도와 정확성 모두 우수한 결과를 보여주고 있다.

### 비지도 동영상 객체 분할

주로 두 갈래를 사용하는 투 스트림 방식을 이용한다.

- 스트림1: RGB 색상 영상(외형 정보). 우리가 흔히 보는 일반적인 형태의 동영상 프레임 이미지이다. 이 경로를 지나는 인코더는 객체의 색상, 질감, 형태, 윤곽선 같은 시각적(공간적) 특징을 꼼꼼하게 추출한다.
- 스트림2: 광흐름(Optical flow) 크기 영상(움직임 정보) . 인접한 두 프레임을 비교해서 픽셀들이 어느 방향으로 이동했는지를 계산한 데이터이다. 이 경로의 인코더는 대상이 어떻게 움직이고 있는지, 즉 배경과 다르게 독자적인 궤적을 그리는 부분이 어디인지(시간적 특징)에 집중하여 특징을 추출한다.
- 이 방식을 사용하는 이유: 두 스트림이 서로의 단점을 완벽하게 보완해주기 때문에 이 방식을 사용한다.
    - 숲 속에 보호색을 띈 동물: RGB 스트림 만으로는 배경과 구분해내기 힘들지만, 동물이 움직이는 순간 광흐름 스트림이 그 영역을 포착해낼 수 있다.
    - 객체가 갑자기 움직임을 멈춘 경우: 광흐름 정보가 0에 가까워진다. 하지만 RGB 스트림이 뚜렷한 외형 정보를 유지하고 있기 때문에 객체를 놓치지 않고 분할할 수 있다.

### 준지도 동영상 객체 분할

- 샴 네트워크: 똑같이 생긴 두 개의 신경망(인코더)을 나란히 이어 붙인 구조를 의미한다.
